### Security

* Add line length and header count limits to prevent DoS attacks. Configurable via the `TOC_MARKDOWN_MAX_LINE_LENGTH` environment variable.
* Harden `parse_file` against file-size DoS with 100MiB hard cap.
* Detect concurrent edits before file replacement.
* Fix TOC marker detection in code blocks to prevent bypassing validation.